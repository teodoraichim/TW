<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="css/singlecoding.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto:500&display=swap" rel="stylesheet">
    <title>Code</title>
</head>

<body>
    <div id="left" class="column">
        <div class="top-left">
            <ul>
                <li><img src="img/user.svg">
                </li>
            </ul>
        </div>
        <div class="bottom">
            <ul>
                <a id="project" href="projects.html">
                    <li>Project</li>
                </a>
                <a id="table" href="#">
                    <li>Table</li>
                </a>
                <div class="table">
                    <div id="additional-links">
                        <a href="newtable.html">
                            <li>New table</li>
                        </a><a href="viewtables.html">
                            <li>View tables</li>
                        </a>
                    </div>
                </div>
                <a id="query" href="singlecoding.html">
                    <li>Query</li>
                </a>
            </ul>
        </div>
    </div>
    <div id="right" class="column">
        <div class="top-right">
            <div class="dropdown">
                <p class="textdropdown">
                        ‚ôæÔ∏èÔ∏è Convert
                </p>
                <div class="contentdropdown">
                    <button class="button" id="phpConvert">Convert to PHP</button>
                    <button class="button" id="javaConvert">Convert to Java</button>
                    <button class="button" id="pythonConvert">Convert to Python</button>
                </div>
            </div>
        <button class="run" id="run">
                ‚ñ∂Ô∏è Run
        </button>
        <p id="output">Output
        </p>
        <p id="coding">Coding
        </p>
        <div class="dropdown2">
                <p class="textdropdown2">
                        üîî Notification
                </p>
                <div class="contentdropdown2">
                    <a href="#1">1</a>
                    <a href="#2">2</a>
                </div>
            </div>
        </div>
        <div class="bottom">
        <textarea class="scroll" id="codingtext"></textarea>
        <textarea class="scroll" id="outputtext"></textarea>
        </div>
    </div>

    <script>
        let jwt = "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJpYXQiOjE1NjAyODE2MjgsImV4cCI6MTU2MDMyNDgyOCwiYXVkIjoiaHR0cDovL2xvY2FsaG9zdCIsImlzcyI6IlVQTlAiLCJzdWIiOiJzb21lQHVzZXIuY29tIn0.P1PJEuW3LKBOPXVyNUUyI5MuYGAqh236jL2r85EN7ZqGnwPcSGXXTIS3eOeb-n6c7f2OKv1FaiviDAAOCEE7jg";
        let content = document.getElementById("additional-links");
        content.hidden = true;
        let table = document.getElementById("table");
        const style = getComputedStyle(content);
        table.addEventListener("click",
            function () {
                if (style.display == "block")
                    content.hidden = true;
                else
                    content.hidden = false;
            }, false);

        let coding = document.getElementById("coding");
        coding.hidden = true;
        let output = document.getElementById("output");
        let codetext = document.getElementById("codingtext");
        let outputtext = document.getElementById("outputtext");
        let run=document.getElementById("run");
        output.addEventListener("click", function(){
            codetext.hidden = true;
            output.hidden = true;
            coding.hidden = false;
            outputtext.hidden = false;
        });
        run.addEventListener("click", function(){
            let code=document.getElementById("codingtext").value;
            console.log(code);
            ExecuteQuery(jwt,14,code);
        });
        function ExecuteQuery(jwt, projectID, querysql) {
        let query = "http://192.168.1.8:8000/projects/query?project_id=" + projectID + "&query=" + querysql;
        let bearer = 'Bearer ' + jwt;
        fetch(query, {
            method: 'POST',
            // withCredentials: true,
            // credentials: 'include',
            // mode:"no-cors",
            headers: {
                'Authorization': bearer,
                // 'Content-Type': 'application/json'
            }
        }).then((resp) => {
            if (resp.status == 200) { console.log("OK"); return resp.json(); }
            else if (resp.status == 500) { console.log("500"); }
            else if (resp.status = 401) { console.log("401"); }


        }).then(jsonResp => {
            if (jsonResp)
                document.getElementById("outputtext")=jsonResp["result"];
        });
        let javaC=document.getElementById("javaConvert");
        javaC.addEventListener("click",function(){
            let code=document.getElementById("codingtext").value;
            GenerateJavaCode(jwt,14,code)
        });
        function GenerateJavaCode(jwt, projectID, querysql) {
        let query = "http://192.168.1.8:8000/generateCode/Java?project_id=" + projectID + "&query=" + querysql;
        let bearer = 'Bearer ' + jwt;
        fetch(query, {
            method: 'POST',
            // withCredentials: true,
            // credentials: 'include',
            // mode:"no-cors",
            headers: {
                'Authorization': bearer,
                // 'Content-Type': 'application/json'
            }
        }).then((resp) => {
            if (resp.status == 200) { return resp.json(); }
            else if (resp.status == 500) { console.log("500"); }
            else if (resp.status = 401) { console.log("401"); }


        }).then(jsonResp => {
            if (jsonResp)
                document.getElementById("outputtext")=jsonResp["result"];
        });
    let phpC=document.getElementById("phpConvert");
    phpC.addEventListener("click",function(){
        let code=document.getElementById("codingtext").value;
        GeneratePhpCode(jwt,14,code);
    });
    function GeneratePhpCode(jwt, projectID, querysql) {
        let query = "http://192.168.1.8:8000/generateCode/Php?project_id=" + projectID + "&query=" + querysql;
        let bearer = 'Bearer ' + jwt;
        fetch(query, {
            method: 'POST',
            // withCredentials: true,
            // credentials: 'include',
            // mode:"no-cors",
            headers: {
                'Authorization': bearer,
                // 'Content-Type': 'application/json'
            }
        }).then((resp) => {
            if (resp.status == 200) { return resp.json(); }
            else if (resp.status == 500) { console.log("500"); }
            else if (resp.status = 401) { console.log("401"); }


        }).then(jsonResp => {
            if (jsonResp)
                console.log(jsonResp["result"]);
        });

    }
    }
    }
        coding.addEventListener("click", function(){
            outputtext.hidden = true;
            coding.hidden = true;
            output.hidden = false;
            codetext.hidden = false;
        });
    </script>

</body>

</html>